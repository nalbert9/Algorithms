ACCESS_TOKEN="YOUR_ACCESS_TOKEN"
PROXY_URL="http://yourproxy:port"
SITE_ID="YOUR_SITE_ID"

curl -x $PROXY_URL -H "Authorization: Bearer $ACCESS_TOKEN" -H "Content-Type: application/json" "https://graph.microsoft.com/v1.0/sites/$SITE_ID"

------------------------------------------
Get access token 
------------------------------------------

import requests

tenant_id = "YOUR_TENANT_ID"
client_id = "YOUR_CLIENT_ID"
client_secret = "YOUR_CLIENT_SECRET"
scope = "https://graph.microsoft.com/.default"
grant_type = "client_credentials"

url = f"https://login.microsoftonline.com/{tenant_id}/oauth2/v2.0/token"
data = {
    "client_id": client_id,
    "scope": scope,
    "client_secret": client_secret,
    "grant_type": grant_type,
}

response = requests.post(url, data=data)
access_token = response.json().get("access_token")

--------------------------------------------


import requests

site_id = "SITE_ID"
drive_id = "DRIVE_ID"
file_name = "FILE_NAME"
file_path = "/local/path/to/your/file.txt"
upload_url = f"https://graph.microsoft.com/v1.0/sites/{site_id}/drives/{drive_id}/root:/{file_name}:/content"

headers = {
    "Authorization": f"Bearer {access_token}",
    "Content-Type": "text/plain",
}

with open(file_path, "rb") as file_data:
    response = requests.put(upload_url, headers=headers, data=file_data)

print(response.json())


openssl pkcs12 -in yourfile.pfx -clcerts -nokeys -out certificate.crt

openssl pkcs12 -in yourfile.pfx -nocerts -out privatekey.pem


openssl rsa -in privatekey.pem -out privatekey_unencrypted.pem
