import requests

# Set your SharePoint URL
sharepoint_url = "https://your-sharepoint-url.com"

# Set your proxy URL
proxy_url = "https://your-proxy-url.com"

# Set the SharePoint file URL
file_url = f"{sharepoint_url}/path/to/your/file.txt"

# Set the path to your PFX certificate file and its password
certificate_path = "path/to/your/certificate.pfx"
certificate_password = "your-certificate-password"

# Define proxy settings
proxy_settings = {
    'http': proxy_url,
    'https': proxy_url,
}

# Load the PFX certificate
cert = (certificate_path, certificate_password)

# Make the request through the proxy to access SharePoint
try:
    response = requests.get(file_url, proxies=proxy_settings, cert=cert, verify=False)

    # Check if the request was successful (status code 200)
    if response.status_code == 200:
        print("Connection to SharePoint through the proxy successful.")
    else:
        print(f"Error accessing SharePoint through the proxy. Status code: {response.status_code}")

except requests.RequestException as e:
    print(f"Request error: {e}")
